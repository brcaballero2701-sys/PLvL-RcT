import{j as e}from"./app-RZ6KLPYO.js";import{r as g,u as b,H as f,L as c}from"./vendor-x9zrslyQ.js";import{u as y}from"./useSystemColors-YCC1fkpO.js";import{A as j}from"./arrow-left-CnFJRCdA.js";import{S as v}from"./shield-sybB8x6n.js";import{R as x}from"./rotate-ccw-D3c9r7hf.js";import{T as u}from"./triangle-alert-BIyt8psk.js";import{C as p}from"./circle-check-big-BY_4AP0I.js";import{S as N}from"./save-CdFK5_sq.js";import{S as w}from"./settings-BHex1vnf.js";import"./createLucideIcon-DJ0S87ah.js";function D({securitySettings:o}){const{colors:t}=y(),[d,i]=g.useState(!1),{data:r,setData:a,post:l,processing:n,errors:k}=b({password_min_length_enabled:o.password_min_length_enabled||!0,password_min_length:o.password_min_length||8,password_require_mixed_case:o.password_require_uppercase||!1,password_require_numbers:o.password_require_numbers||!1,password_require_symbols:o.password_require_symbols||!1,password_mixed_case_enabled:o.password_mixed_case_enabled||!0,two_factor_enabled:o.two_factor_enabled||!1,two_factor_method:o.two_factor_method||"email",auto_lock_enabled:o.auto_lock_enabled||!0,auto_lock_attempts:o.auto_lock_attempts||3,password_recovery_enabled:o.password_recovery_enabled||!0,password_recovery_method:o.password_recovery_method||"email",recovery_code_expiry:o.recovery_code_expiry||15,recovery_attempts_limit:o.recovery_attempts_limit||3}),h=s=>{s.preventDefault(),i(!0),l(route("configuraciones.seguridad"),{onSuccess:()=>{alert("Configuraciones de seguridad actualizadas exitosamente")},onError:_=>{console.error("Errores:",_),alert("Error al actualizar las configuraciones")},onFinish:()=>{i(!1)}})},m=()=>{confirm("¬øEst√°s seguro de restablecer todas las configuraciones de seguridad a los valores por defecto?")&&l(route("configuraciones.resetear-contrase√±as"),{onSuccess:()=>{alert("Configuraciones restablecidas a valores por defecto"),window.location.reload()}})};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(f,{title:"Seguridad y Contrase√±as - SENA"}),e.jsx("div",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(c,{href:route("admin.configuraciones"),className:"mr-4 p-2 text-gray-600 hover:text-gray-900 transition-colors",children:e.jsx(j,{size:20})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:`mr-3 ${t.primaryText}`,size:24}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Seguridad y Contrase√±as"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configura las pol√≠ticas de seguridad del sistema"})]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:m,className:"flex items-center px-4 py-2 text-gray-600 hover:text-red-600 transition-colors",children:[e.jsx(x,{size:16,className:"mr-2"}),"Restablecer"]}),e.jsx(c,{href:route("admin.configuraciones"),className:`px-4 py-2 ${t.primary} text-white rounded-md hover:opacity-90 transition-opacity`,children:"Volver"})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:e.jsxs("form",{onSubmit:h,className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Definir pol√≠ticas de contrase√±a"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"password_min_length_enabled",checked:r.password_min_length_enabled,onChange:s=>a("password_min_length_enabled",s.target.checked),className:`h-4 w-4 ${t.primary} border-gray-300 rounded focus:ring-2 focus:ring-offset-2 focus:ring-green-500`}),e.jsxs("label",{htmlFor:"password_min_length_enabled",className:"ml-3 text-base font-medium text-gray-900",children:["M√≠nimo ",r.password_min_length," caracteres."]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"6",max:"20",value:r.password_min_length,onChange:s=>a("password_min_length",parseInt(s.target.value)),className:"w-16 px-2 py-1 border border-gray-300 rounded-md text-center text-sm",disabled:!r.password_min_length_enabled}),e.jsx("span",{className:"text-sm text-gray-500",children:"caracteres"})]})]}),e.jsx("hr",{className:"border-gray-200"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-medium text-gray-900 mb-4",children:"Uso de may√∫sculas, n√∫meros y caracteres especiales"}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"password_mixed_case_enabled",checked:r.password_mixed_case_enabled,onChange:s=>a("password_mixed_case_enabled",s.target.checked),className:`h-4 w-4 ${t.primary} border-gray-300 rounded focus:ring-2 focus:ring-offset-2 focus:ring-green-500`}),e.jsx("label",{htmlFor:"password_mixed_case_enabled",className:"ml-3 text-base font-medium text-gray-900",children:"Activar / caulmenar"})]})}),r.password_mixed_case_enabled&&e.jsxs("div",{className:"mt-4 ml-7 space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"password_require_mixed_case",checked:r.password_require_mixed_case,onChange:s=>a("password_require_mixed_case",s.target.checked),className:`h-4 w-4 ${t.primary} border-gray-300 rounded focus:ring-2 focus:ring-offset-2 focus:ring-green-500`}),e.jsx("label",{htmlFor:"password_require_mixed_case",className:"ml-3 text-sm text-gray-700",children:"Requerir may√∫sculas y min√∫sculas"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"password_require_numbers",checked:r.password_require_numbers,onChange:s=>a("password_require_numbers",s.target.checked),className:`h-4 w-4 ${t.primary} border-gray-300 rounded focus:ring-2 focus:ring-offset-2 focus:ring-green-500`}),e.jsx("label",{htmlFor:"password_require_numbers",className:"ml-3 text-sm text-gray-700",children:"Requerir n√∫meros"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"password_require_symbols",checked:r.password_require_symbols,onChange:s=>a("password_require_symbols",s.target.checked),className:`h-4 w-4 ${t.primary} border-gray-300 rounded focus:ring-2 focus:ring-offset-2 focus:ring-green-500`}),e.jsx("label",{htmlFor:"password_require_symbols",className:"ml-3 text-sm text-gray-700",children:"Requerir caracteres especiales (!@#$%^&*)"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Activar/desactivar autenticaci√≥n en dos pasos (2FA)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"two_factor_enabled",checked:r.two_factor_enabled,onChange:s=>a("two_factor_enabled",s.target.checked),className:`h-4 w-4 ${t.primary} border-gray-300 rounded focus:ring-2 focus:ring-offset-2 focus:ring-green-500`}),e.jsx("label",{htmlFor:"two_factor_enabled",className:"ml-3 text-base font-medium text-gray-900",children:"Activar autenticaci√≥n en dos pasos"})]})}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"two_factor_auto_lock",checked:r.two_factor_auto_lock,onChange:s=>a("two_factor_auto_lock",s.target.checked),className:`h-4 w-4 ${t.primary} border-gray-300 rounded focus:ring-2 focus:ring-offset-2 focus:ring-green-500`,disabled:!r.two_factor_enabled}),e.jsx("label",{htmlFor:"two_factor_auto_lock",className:"ml-3 text-base font-medium text-gray-900",children:"Bloqueo autom√°tico"})]})}),!r.two_factor_enabled&&e.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{className:"text-yellow-600",size:16}),e.jsx("p",{className:"ml-2 text-sm text-yellow-800",children:"La autenticaci√≥n en dos pasos est√° desactivada. Se recomienda activarla para mayor seguridad."})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Bloqueo autom√°tico tras X intentos fallidos de inicio de sesi√≥n"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"auto_lock_enabled",checked:r.auto_lock_enabled,onChange:s=>a("auto_lock_enabled",s.target.checked),className:`h-4 w-4 ${t.primary} border-gray-300 rounded focus:ring-2 focus:ring-offset-2 focus:ring-green-500`}),e.jsx("label",{htmlFor:"auto_lock_enabled",className:"ml-3 text-base font-medium text-gray-900",children:"Bloqueo autom√°tico"})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"N√∫mero m√°ximo de intentos:"}),e.jsx("input",{type:"number",min:"1",max:"10",value:r.auto_lock_attempts,onChange:s=>a("auto_lock_attempts",parseInt(s.target.value)),className:"w-20 px-3 py-2 border border-gray-300 rounded-md text-center",disabled:!r.auto_lock_enabled}),e.jsx("span",{className:"text-sm text-gray-500",children:"intentos"})]}),r.auto_lock_enabled&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"text-green-600",size:16}),e.jsxs("p",{className:"ml-2 text-sm text-green-800",children:["Los usuarios ser√°n bloqueados autom√°ticamente despu√©s de ",r.auto_lock_attempts," intentos fallidos de inicio de sesi√≥n."]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Recuperaci√≥n de contrase√±a por email o tel√©fono"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"password_recovery_enabled",checked:r.password_recovery_enabled,onChange:s=>a("password_recovery_enabled",s.target.checked),className:`h-4 w-4 ${t.primary} border-gray-300 rounded focus:ring-2 focus:ring-offset-2 focus:ring-green-500`}),e.jsx("label",{htmlFor:"password_recovery_enabled",className:"ml-3 text-base font-medium text-gray-900",children:"Activar recuperaci√≥n de contrase√±a"})]})}),r.password_recovery_enabled&&e.jsxs("div",{className:"space-y-4 ml-7",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"M√©todo de recuperaci√≥n:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"recovery_email",name:"recovery_method",value:"email",checked:r.password_recovery_method==="email",onChange:s=>a("password_recovery_method",s.target.value),className:`h-4 w-4 ${t.primary} border-gray-300 focus:ring-2 focus:ring-offset-2 focus:ring-green-500`}),e.jsx("label",{htmlFor:"recovery_email",className:"ml-3 text-sm text-gray-700",children:"üìß Solo por correo electr√≥nico"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"recovery_phone",name:"recovery_method",value:"phone",checked:r.password_recovery_method==="phone",onChange:s=>a("password_recovery_method",s.target.value),className:`h-4 w-4 ${t.primary} border-gray-300 focus:ring-2 focus:ring-offset-2 focus:ring-green-500`}),e.jsx("label",{htmlFor:"recovery_phone",className:"ml-3 text-sm text-gray-700",children:"üì± Solo por n√∫mero telef√≥nico (SMS)"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"recovery_both",name:"recovery_method",value:"both",checked:r.password_recovery_method==="both",onChange:s=>a("password_recovery_method",s.target.value),className:`h-4 w-4 ${t.primary} border-gray-300 focus:ring-2 focus:ring-offset-2 focus:ring-green-500`}),e.jsx("label",{htmlFor:"recovery_both",className:"ml-3 text-sm text-gray-700",children:"üìßüì± Ambos m√©todos (usuario puede elegir)"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tiempo de expiraci√≥n del c√≥digo:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"5",max:"60",value:r.recovery_code_expiry,onChange:s=>a("recovery_code_expiry",parseInt(s.target.value)),className:"w-20 px-3 py-2 border border-gray-300 rounded-md text-center text-sm"}),e.jsx("span",{className:"text-sm text-gray-500",children:"minutos"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"L√≠mite de intentos de recuperaci√≥n:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"1",max:"5",value:r.recovery_attempts_limit,onChange:s=>a("recovery_attempts_limit",parseInt(s.target.value)),className:"w-20 px-3 py-2 border border-gray-300 rounded-md text-center text-sm"}),e.jsx("span",{className:"text-sm text-gray-500",children:"intentos por d√≠a"})]})]})]}),e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(p,{className:"text-blue-600 mt-0.5",size:16}),e.jsxs("div",{className:"ml-2",children:[e.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Configuraci√≥n actual:"}),e.jsxs("ul",{className:"text-xs text-blue-700 mt-1 space-y-1",children:[e.jsxs("li",{children:["‚Ä¢ M√©todo: ",r.password_recovery_method==="email"?"Solo correo electr√≥nico":r.password_recovery_method==="phone"?"Solo SMS":"Email y SMS (usuario elige)"]}),e.jsxs("li",{children:["‚Ä¢ C√≥digo expira en ",r.recovery_code_expiry," minutos"]}),e.jsxs("li",{children:["‚Ä¢ M√°ximo ",r.recovery_attempts_limit," intentos por d√≠a"]})]})]})]})})]}),!r.password_recovery_enabled&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{className:"text-red-600",size:16}),e.jsxs("p",{className:"ml-2 text-sm text-red-800",children:[e.jsx("strong",{children:"Advertencia:"})," La recuperaci√≥n de contrase√±a est√° desactivada. Los usuarios no podr√°n recuperar sus contrase√±as si las olvidan."]})]})})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("button",{type:"submit",disabled:n||d,className:`flex items-center px-6 py-3 ${t.primary} text-white rounded-md hover:opacity-90 transition-opacity disabled:opacity-50`,children:[e.jsx(N,{size:16,className:"mr-2"}),n||d?"Guardando...":"Guardar Configuraciones"]}),e.jsx(c,{href:route("admin.configuraciones"),className:"flex items-center px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancelar"})]}),e.jsxs("button",{type:"button",onClick:m,className:"flex items-center px-4 py-2 text-red-600 hover:bg-red-50 rounded-md transition-colors",children:[e.jsx(x,{size:16,className:"mr-2"}),"Restablecer por Defecto"]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsxs("h4",{className:"text-lg font-semibold text-blue-900 mb-3 flex items-center",children:[e.jsx(w,{className:"mr-2",size:20}),"üí° Recomendaciones de Seguridad"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-blue-800",children:[e.jsx("li",{children:"‚Ä¢ Se recomienda activar todas las pol√≠ticas de contrase√±a para mayor seguridad"}),e.jsx("li",{children:"‚Ä¢ La autenticaci√≥n en dos pasos proporciona una capa adicional de protecci√≥n"}),e.jsx("li",{children:"‚Ä¢ Un l√≠mite de 3-5 intentos de login es recomendable para prevenir ataques de fuerza bruta"}),e.jsx("li",{children:"‚Ä¢ Las contrase√±as deben tener al menos 8 caracteres con combinaci√≥n de may√∫sculas, n√∫meros y s√≠mbolos"}),e.jsx("li",{children:"‚Ä¢ Revisa regularmente las configuraciones de seguridad para mantener el sistema protegido"})]})]})]})})]})}export{D as default};
